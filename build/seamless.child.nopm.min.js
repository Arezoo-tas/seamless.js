/*! seamless.js 2014-04-12 */
var SeamlessBase={getParam:function(a,b){b=b||window.location.search;var c="[?&]"+a+"=([^&#]*)",d=new RegExp(c),e=d.exec(b);return null===e?"":decodeURIComponent(e[1].replace(/\+/g," "))}},SeamlessConnection=function(a,b){this.id=null,this.target=a,this.url=b,this.active=!1,this.queue=[];var c=SeamlessBase.getParam("iframeId");c&&(this.id=c)};SeamlessConnection.prototype.send=function(a){this.active&&this.target?(a.hasOwnProperty("data")||(a={data:a}),a.target=this.target,a.url=this.url,a.type=a.type||"seamless_data",a.data=a.data||{},a.data.__id=this.id,$.pm(a)):this.queue.push(a)},SeamlessConnection.prototype.receive=function(a,b){"function"==typeof a&&(b=a,a="seamless_data");var c=this;$.pm.bind(a,function(a,d){return a.__id===c.id?b(a,d):!1})},SeamlessConnection.prototype.setActive=function(a){if(this.active=a,this.queue.length>0){for(var b in this.queue)this.send(this.queue[b]);this.queue=[],this.queue.length=0}},function(a,b,c){return c.hasOwnProperty("pm")?void(c.seamless={options:{url:"",container:"body",update:200},connect:function(b){b=b||{};for(var d in b)this.options.hasOwnProperty(d)&&(this.options[d]=b[d]);b=this.options;var e=new SeamlessConnection(a.parent,b.url);e.setActive(!0);var f=SeamlessBase.getParam("noiframe").toString();if("1"===f||"true"===f.toLowerCase())e.send({type:"seamless_noiframe",data:{href:a.location.href}});else{var g=!1,h=b.container,i=0,j=0,k=function(){var a=c(h).outerHeight(!0);a=a>100?a:100,g||i===a||(g=!0,e.send({type:"seamless_update",data:{height:a},success:function(a){i=a.height,g=!1}})),j&&clearTimeout(j),j=setTimeout(k,b.update)},l=function(){e.id||(e.send({type:"seamless_ready",data:{}}),setTimeout(l,200))};c.pm.bind("seamless_connect",function(a){e.id=a.id,k()}),l()}return e}}):void console.log("You must install the jQuery.pm module to use seamless.js.")}(window,document,jQuery);